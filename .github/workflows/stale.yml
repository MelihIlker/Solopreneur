name: Mark and Close Stale Issues and Pull Requests

on:
  schedule:
    # Run every Monday at 9:00 AM UTC (sprint start)
    - cron: '0 9 * * 1'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          # ============ ISSUES ============
          days-before-issue-stale: 21
          days-before-issue-close: 7
          stale-issue-label: 'stale'
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had recent activity for 21 days.
            
            If this issue is still relevant to the MVP roadmap or future features, please comment to keep it open. Otherwise, it will be closed in 7 days.
            
            Thank you for your contribution! üôè
          close-issue-message: |
            This issue has been automatically closed due to inactivity.
            
            If you believe this issue is still relevant, feel free to reopen it or create a new issue with updated information.

          # ============ PULL REQUESTS ============
          days-before-pr-stale: 7
          days-before-pr-close: 3
          stale-pr-label: 'stale'
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity for 7 days.
            
            If you plan to continue working on this PR, please push new commits or comment. Otherwise, it will be closed in 3 days.
            
            Thank you for your effort! üôè
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.
            
            Feel free to reopen if you'd like to continue working on it or create a new PR with your changes.

          # ============ EXEMPTIONS ============
          # These labels prevent closure
          exempt-issue-labels: 'bug,security,mvp,critical,pinned,wontfix'
          exempt-pr-labels: 'mvp,critical,security,pinned,wip,wontfix'
          
          # ============ OPERATIONS ============
          operations-per-run: 30
          remove-stale-when-updated: true
          remove-stale-when-commented: true
          remove-stale-when-labeled: true
